{
  "buildCommand": "node scripts/switch-schema-auto.js && \
    # Mapear aliases comuns do Supabase para compatibilidade \
    if [ -z \"$DATABASE_URL\" ] && [ -n \"$POSTGRES_PRISMA_URL\" ]; then export DATABASE_URL=\"$POSTGRES_PRISMA_URL\"; fi; \
    if [ -z \"$DATABASE_URL\" ] && [ -n \"$POSTGRES_URL\" ]; then export DATABASE_URL=\"$POSTGRES_URL\"; fi; \
    npx prisma generate && \
    if [ -n \"$DATABASE_URL_NON_POOLING\" ] && [ -z \"$DIRECT_URL\" ]; then export DIRECT_URL=\"$DATABASE_URL_NON_POOLING\"; fi; \
    if [ -n \"$POSTGRES_URL_NON_POOLING\" ] && [ -z \"$DIRECT_URL\" ]; then export DIRECT_URL=\"$POSTGRES_URL_NON_POOLING\"; fi; \
    if [ -n \"$DIRECT_URL\" ] && [ -n \"$DATABASE_URL\" ]; then npx prisma migrate deploy; else echo 'Skipping prisma migrate deploy: require DATABASE_URL and DIRECT_URL (or DATABASE_URL_NON_POOLING/POSTGRES_URL_NON_POOLING)'; fi; \
    next build"
}